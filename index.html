<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Prestamos - V6</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="style.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">
<div class="toast-container position-fixed top-0 start-50 translate-middle-x p-3">
  </div>
<div class="container py-4">
  <h2 class="mb-4">üìÇ Gesti√≥n de Pr√©stamos ‚Äî V9</h2>

  <!-- Nav -->
  <!-- Nav -->
<ul class="nav nav-tabs" id="tabs">
  <li class="nav-item">
    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-dashboard">Dashboard</button>
  </li>
  <li class="nav-item">
    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-clientes">Clientes</button>
  </li>
  <li class="nav-item">
    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-prestamos">Pr√©stamos</button>
  </li>
  <li class="nav-item">
    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-abonos">Abonos</button>
  </li>
  <li class="nav-item">
    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-historial">Historial</button>
  </li>
  <li class="nav-item ms-auto">
  <button class="btn btn-sm btn-outline-danger" id="btnLogout" style="margin-top: 5px;">
    Cerrar Sesi√≥n (<span id="userEmailDisplay">...</span>)
  </button>
</li>
</ul>

<div class="tab-content mt-3">

  <!-- DASHBOARD -->
  <div class="tab-pane fade show active" id="tab-dashboard">
    <div class="row g-3 mb-3">
      <div class="col-md-6">
        <div class="card p-3 text-center">
          <h5>Total Pr√©stamos</h5>
          <h2 id="dashTotalPrestamos">0</h2>
          <small id="dashPrestamosTrend"></small>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card p-3 text-center">
          <h5>Total Abonos</h5>
          <h2 id="dashTotalAbonos">0</h2>
          <small id="dashAbonosTrend"></small>
        </div>
      </div>
    </div>

    <div class="row g-3 mb-3">
  <div class="col-md-6">
    <div class="card p-3 text-center">
      <h5>Cuotas vencidas</h5>
      <h2 class="text-danger" id="dashCuotasVencidas">0</h2>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card p-3 text-center">
      <h5>Cuotas pr√≥ximas a vencer</h5>
      <h2 class="text-warning" id="dashCuotasPorVencer">0</h2>
    </div>
  </div>
</div>



    <div class="card p-3">
      <h5>Comparaci√≥n</h5>
      <canvas id="dashChart" style="width:100%;height:250px;"></canvas>

      <div class="card p-3 mt-3">
  <h5>Pr√©stamos por cliente</h5>
  <canvas id="dashChartClientes" style="width:100%;max-height:250px;"></canvas>
</div>

    </div>
  </div>

    <!-- CLIENTES -->
    <div class="tab-pane fade" id="tab-clientes">
      <div class="card p-3 mb-3">
        <h5>Registrar cliente</h5>
        <form id="clienteForm" class="row g-2">
          <div class="col-md-5"><input id="clienteNombre" class="form-control" placeholder="Nombre" required></div>
          <div class="col-md-4"><input id="clienteTelefono" class="form-control" placeholder="Tel√©fono"></div>
          <div class="col-md-3"><button class="btn btn-primary">Agregar</button></div>
        </form>
      </div>

      <div class="card p-3">
        <h5>Lista de clientes</h5>
        <ul id="clientesList" class="list-group"></ul>
      </div>
    </div>

    <!-- PRESTAMOS -->
    <div class="tab-pane fade" id="tab-prestamos">
      <div class="card p-3 mb-3">
        <h5>Registrar pr√©stamo</h5>
        <form id="prestamoForm" class="row g-2">
          <div class="col-md-4">
            <select id="prestamoCliente" class="form-select" required><option value=''>Cargando clientes...</option></select>
          </div>
          <div class="col-md-2"><input id="prestamoMonto" class="form-control" type="number" step="0.01" placeholder="Monto" required></div>
          <div class="col-md-2">
            <div class="input-group">
              <input id="prestamoInteres" class="form-control" type="number" step="0.01" value="0" placeholder="Inter√©s" aria-label="Inter√©s">
              <span class="input-group-text">%</span>
            </div>
            <small class="text-muted" style="margin-left:2px;">Porcentaje de inter√©s</small>
          </div>
          <div class="col-md-2"><input id="prestamoCuotas" class="form-control" type="number" placeholder="N¬∞ Cuotas" required></div>
          <div class="col-md-2"><input id="prestamoBanco" class="form-control" placeholder="Banco (opcional)"></div>
          <div class="col-12"><input id="prestamoObs" class="form-control" placeholder="Observaci√≥n (opcional)"></div>
          <div class="col-12 text-end"><button class="btn btn-success">Registrar pr√©stamo</button></div>
        </form>
      </div>

      <div class="card p-3">
        <h5>Pr√©stamos existentes</h5>
        <ul id="prestamosList" class="list-group"></ul>
      </div>
    </div>

    <!-- ABONOS -->
    <div class="tab-pane fade" id="tab-abonos">
      <div class="card p-3 mb-3">
        <h5>Registrar abono</h5>
        <form id="abonoForm" class="row g-2">
          <div class="col-md-4">
            <select id="filtroClienteAbono" class="form-select"><option value=''>Filtrar por cliente (opcional)</option></select>
          </div>
          <div class="col-md-5">
            <select id="abonoPrestamo" class="form-select" required><option value=''>Seleccione pr√©stamo</option></select>
          </div>
          <div class="col-md-2"><input id="abonoMonto" class="form-control" type="number" step="0.01" placeholder="Monto" required></div>
          <div class="col-md-1"><button class="btn btn-warning w-100">Abonar</button></div>
        </form>
      </div>

      <div class="card p-3">
        <h5>√öltimos abonos</h5>
        <ul id="abonosList" class="list-group"></ul>
      </div>
    </div>

    <!-- HISTORIAL -->
    <div class="tab-pane fade" id="tab-historial">
      <div class="card p-3 mb-3">
        <div class="row g-2 align-items-center">
          <div class="col-md-4">
            <input id="historialFiltro" class="form-control" placeholder="Buscar por cliente (nombre) o dejar vac√≠o para todos">
          </div>
          <div class="col-md-8 text-end">
            <button id="btnRefrescarHistorial" class="btn btn-outline-primary">Refrescar</button>
          </div>
        </div>
      </div>

      <div class="card p-3">
        <h5>Historial de pr√©stamos</h5>
        <div class="table-responsive">
          <table id="historialTable" class="table table-sm table-hover">
            <thead>
              <tr>
                <th>Pr√©stamo ID</th><th>Cliente</th><th>Monto</th><th>Inter√©s %</th><th>Cuotas</th><th>Total Abonado</th><th>Saldo</th><th>Banco</th><th>Obs</th><th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

    </div>

  </div>
</div>

<script type="module" src="main.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
